<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ taglib prefix = "c" uri = "http://java.sun.com/jsp/jstl/core" %>
<%@ taglib prefix="form" uri="http://www.springframework.org/tags/form" %>
<%@ taglib prefix="spring" uri="http://www.springframework.org/tags" %>
<%@ taglib uri="http://java.sun.com/jsp/jstl/fmt" prefix="fmt"  %>



<%@ include file="../includes/head.jsp"%>

<body class="font-sans bg-gray-100">
<div id="app">

    <jsp:include page="../includes/nav.jsp"></jsp:include>

    <div class=" min-h-screen">
        <div class="py-4">
            <div class="max-w-4xl mx-auto px-4 sm:px-4 lg:px-4">

                <div class="bg-white rounded-lg shadow p-6">
                    <div class="flex justify-between">
                        <nav class="flex items-center text-sm leading-5 font-medium">
                            <a href="${contextUrl}/projects" class="text-gray-500 hover:text-gray-700 transition duration-150 ease-in-out">
                                Home
                            </a>
                        </nav>

                        <div>

                        </div>

                    </div>


                    <div class="mt-4">
                        <div class="flex justify-between">
                            <div class="text-xl font-bold text-gray-900 sm:text-md  sm:truncate">
                                Notifications
                            </div>
                        </div>
                        <%-- <div class="mt-1 flex items-center text-sm leading-5 text-gray-500">
                            ${project.description}
                        </div> --%>

                        <div class="mt-1 flex items-center text-sm leading-5 text-gray-500">
                            Here’s every notification you’ve ever received.
                        </div>

                    </div>


                    <div class="mt-6">
                        <div class="flex justify-between">
                            <div class="font-regular text-base md:text-lg leading-snug truncate font-semibold text-red-500">
                                New for you
                            </div>
                        </div>

                    </div>

                    <div class="mt-2">
                        <ul>
                            <c:forEach items="${notifications}" var="notification">
                                <c:if test="${notification.read == false}" >
                                <li wfd-id="80">

                                    <c:if test="${notification.message eq 'new_message'}">
                                    <a href="${contextUrl}/project/${notification.messageObject.projectId}/message/${notification.messageObject.id}"
                                       class="block hover:bg-gray-50 focus:outline-none focus:bg-gray-50 transition duration-150 ease-in-out">
                                    </c:if>

                                    <c:if test="${notification.message eq 'new_todo'}">
                                    <a href="${contextUrl}/project/${notification.todo.project.id}/todo/${notification.todo.id}"
                                       class="block hover:bg-gray-50 focus:outline-none focus:bg-gray-50 transition duration-150 ease-in-out">
                                    </c:if>

                                     <c:if test="${notification.message eq 'new_message_comment'}">
                                      <a href="${contextUrl}/project/${notification.comment.projectId}/message/${notification.comment.message.id}#comment_${notification.comment.id}"
                                         class="block hover:bg-gray-50 focus:outline-none focus:bg-gray-50 transition duration-150 ease-in-out">
                                      </c:if>

                                      <c:if test="${notification.message eq 'new_todo_comment'}">
                                          <a href="${contextUrl}/project/${notification.comment.projectId}/todo/${notification.comment.todo.id}#comment_${notification.comment.id}"
                                            class="block hover:bg-gray-50 focus:outline-none focus:bg-gray-50 transition duration-150 ease-in-out">
                                      </c:if>

                                      <c:if test="${notification.message eq 'completed_todo'}">
                                        <a href="${contextUrl}/project/${notification.todo.project.id}/todo/${notification.todo.id}"
                                        class="block hover:bg-gray-50 focus:outline-none focus:bg-gray-50 transition duration-150 ease-in-out">
                                      </c:if>

                                      <c:if test="${notification.message eq 'new_file'}">
                                        <a href="${contextUrl}/project/${notification.activeStorageFile.project.id}/files"
                                            class="block hover:bg-gray-50 focus:outline-none focus:bg-gray-50 transition duration-150 ease-in-out">
                                      </c:if>

                                        <div class="flex items-center justify-between py-4" wfd-id="81">
                                            <div class="min-w-0 flex-1 flex items-center" wfd-id="84">
                                                <div class="flex-shrink-0" wfd-id="92">
                                                    <img class="h-12 w-12 rounded-full" src="${contextUrl}/avatar/${notification.fromUser.id}/${notification.fromUser.firstName.charAt(0)}${notification.fromUser.lastName.charAt(0)}.svg" alt="" title="${notification.fromUser.firstName} ${notification.fromUser.lastName}">
                                                </div>
                                                <div class="min-w-0 flex-1 px-4 mr-4" wfd-id="85">
                                                    <div wfd-id="86">
                                                        <div class="leading-5 font-gray-900 truncate" wfd-id="90">
                                                            <span class="font-sans truncate" wfd-id="91">

                                                                <c:if test="${notification.message eq 'new_message'}">
                                                                    <span class="mr-1 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium leading-4 bg-indigo-100 text-indigo-800">
                                                                        Message
                                                                    </span>
                                                                </c:if>

                                                                <c:if test="${notification.message eq 'new_todo'}">
                                                                    <span class="mr-1 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium leading-4 bg-red-100 text-red-800">
                                                                        Todo
                                                                    </span>
                                                                </c:if>

                                                                <c:if test="${notification.message eq 'new_message_comment'}">
                                                                    <span class="mr-1 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium leading-4 bg-yellow-100 text-yellow-800">
                                                                        Comment
                                                                    </span>
                                                                </c:if>

                                                                <c:if test="${notification.message eq 'new_todo_comment'}">
                                                                    <span class="mr-1 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium leading-4 bg-yellow-100 text-yellow-800">
                                                                        Comment
                                                                    </span>
                                                                </c:if>

                                                                <c:if test="${notification.message eq 'completed_todo'}">
                                                                    <span class="mr-1 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium leading-4 bg-green-100 text-green-800">
                                                                        Completed
                                                                    </span>
                                                                </c:if>

                                                                <c:if test="${notification.message eq 'new_file'}">
                                                                    <span class="mr-1 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium leading-4 bg-orange-100 text-orange-800">
                                                                        File
                                                                    </span>
                                                                </c:if>

                                                                <span class="">
                                                                        ${notification.messageObject.contentToDisplay}
                                                                        ${notification.todo.description}
                                                                        ${notification.comment.textToDisplay}
                                                                        ${notification.activeStorageFile.fileName}
                                                                </span>


                                                            </span>
                                                        </div>
                                                        <div class="mt-1 flex items-center text-sm leading-5 text-gray-500" wfd-id="87">
                                                            <span class="truncate" wfd-id="88">
                                                                <div class="text-gray-600" wfd-id="89">
                                                                    ${notification.fromUser.firstName} ${notification.fromUser.lastName}
                                                                    •
                                                                    <fmt:formatDate value="${notification.createdAt.time}" pattern="MMM dd, yyyy"/> at <fmt:formatDate value="${notification.createdAt.time}" pattern="hh:mm a"/>
                                                             • ${notification.messageObject.project.name}
                                                               ${notification.todo.project.name}
                                                               ${notification.activeStorageFile.project.name}

                                                            </div>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div wfd-id="82">
                                                <div class="flex items-center justify-center h-3 w-3 rounded-full bg-red-500 text-white">
                                                </div>
                                            </div>

                                        </div>
                                    </a>
                                </li>
                                </c:if>
                            </c:forEach>
                        </ul>
                    </div>



                    <div class="mt-6">
                        <div class="flex justify-between">
                            <div class="font-regular text-base md:text-lg leading-snug truncate font-semibold">
                                Previous notifications
                            </div>
                        </div>

                    </div>

                    <div class="mt-2">
                        <ul>
                            <c:forEach items="${notifications}" var="notification">
                                <c:if test="${notification.read == true}" >
                                    <li wfd-id="80">

                                        <c:if test="${notification.message eq 'new_message'}">
                                            <a href="${contextUrl}/project/${notification.messageObject.projectId}/message/${notification.messageObject.id}"
                                                class="block hover:bg-gray-50 focus:outline-none focus:bg-gray-50 transition duration-150 ease-in-out">
                                        </c:if>

                                        <c:if test="${notification.message eq 'new_todo'}">
                                            <a href="${contextUrl}/project/${notification.todo.project.id}/todo/${notification.todo.id}"
                                               class="block hover:bg-gray-50 focus:outline-none focus:bg-gray-50 transition duration-150 ease-in-out">
                                        </c:if>

                                        <c:if test="${notification.message eq 'new_message_comment'}">
                                            <a href="${contextUrl}/project/${notification.comment.projectId}/message/${notification.comment.message.id}#comment_${notification.comment.id}"
                                                class="block hover:bg-gray-50 focus:outline-none focus:bg-gray-50 transition duration-150 ease-in-out">
                                        </c:if>

                                        <c:if test="${notification.message eq 'new_todo_comment'}">
                                            <a href="${contextUrl}/project/${notification.comment.projectId}/todo/${notification.comment.todo.id}#comment_${notification.comment.id}"
                                                class="block hover:bg-gray-50 focus:outline-none focus:bg-gray-50 transition duration-150 ease-in-out">
                                        </c:if>

                                        <c:if test="${notification.message eq 'completed_todo'}">
                                            <a href="${contextUrl}/project/${notification.todo.project.id}/todo/${notification.todo.id}"
                                                class="block hover:bg-gray-50 focus:outline-none focus:bg-gray-50 transition duration-150 ease-in-out">
                                        </c:if>

                                        <c:if test="${notification.message eq 'new_file'}">
                                            <a href="${contextUrl}/project/${notification.activeStorageFile.project.id}/files"
                                                class="block hover:bg-gray-50 focus:outline-none focus:bg-gray-50 transition duration-150 ease-in-out">
                                        </c:if>

                                            <div class="flex items-center justify-between py-4" wfd-id="81">
                                                <div class="min-w-0 flex-1 flex items-center" wfd-id="84">
                                                    <div class="flex-shrink-0" wfd-id="92">
                                                        <img class="h-12 w-12 rounded-full" src="${contextUrl}/avatar/${notification.fromUser.id}/${notification.fromUser.firstName.charAt(0)}${notification.fromUser.lastName.charAt(0)}.svg" alt="" title="${notification.fromUser.firstName} ${notification.fromUser.lastName}">
                                                    </div>
                                                    <div class="min-w-0 flex-1 px-4 mr-4" wfd-id="85">
                                                        <div>
                                                            <div class="leading-5 font-gray-900 truncate">
                                                            <span class="font-sans truncate" wfd-id="91">

                                                                <c:if test="${notification.message eq 'new_message'}">
                                                                    <span class="mr-1 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium leading-4 bg-indigo-100 text-indigo-800">
                                                                        Message
                                                                    </span>
                                                                </c:if>

                                                                <c:if test="${notification.message eq 'new_todo'}">
                                                                    <span class="mr-1 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium leading-4 bg-red-100 text-red-800">
                                                                        Todo
                                                                    </span>
                                                                </c:if>

                                                                <c:if test="${notification.message eq 'new_message_comment'}">
                                                                    <span class="mr-1 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium leading-4 bg-yellow-100 text-yellow-800">
                                                                        Comment
                                                                    </span>
                                                                </c:if>

                                                                <c:if test="${notification.message eq 'new_todo_comment'}">
                                                                    <span class="mr-1 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium leading-4 bg-yellow-100 text-yellow-800">
                                                                        Comment
                                                                    </span>
                                                                </c:if>

                                                                <c:if test="${notification.message eq 'completed_todo'}">
                                                                    <span class="mr-1 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium leading-4 bg-green-100 text-green-800">
                                                                        Completed
                                                                    </span>
                                                                </c:if>

                                                                <c:if test="${notification.message eq 'new_file'}">
                                                                    <span class="mr-1 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium leading-4 bg-orange-100 text-orange-800">
                                                                        File
                                                                    </span>
                                                                </c:if>

                                                                <span class="">
                                                                        ${notification.messageObject.contentToDisplay}
                                                                        ${notification.todo.description}
                                                                        ${notification.comment.textToDisplay}
                                                                        ${notification.activeStorageFile.fileName}
                                                                </span>


                                                            </span>
                                                            </div>
                                                            <div class="mt-1 flex items-center text-sm leading-5 text-gray-500" wfd-id="87">
                                                            <span class="truncate" wfd-id="88">
                                                                <div class="text-gray-600" wfd-id="89">
                                                                    ${notification.fromUser.firstName} ${notification.fromUser.lastName}
                                                                    •
                                                                    <fmt:formatDate value="${notification.createdAt.time}" pattern="MMM dd, yyyy"/> at <fmt:formatDate value="${notification.createdAt.time}" pattern="hh:mm a"/>
                                                             • ${notification.messageObject.project.name}
                                                               ${notification.todo.project.name}
                                                               ${notification.activeStorageFile.project.name}
                                                                    ${notification.comment.projectId}

                                                            </div>
                                                            </span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>


                                            </div>
                                        </a>
                                    </li>
                                </c:if>
                            </c:forEach>
                        </ul>
                    </div>


                </div>
            </div>
        </div>
    </div>
</div>


    <%@ include file="../includes/notifications.jsp"%>

    <%@ include file="../includes/footer.jsp"%>




